The code in the VNA folder is not mine, I have modified some of it to fit my usage, but all of it is based on code from:
% Writer : C. van Niekerk
% Version : 3.50
% Date : 07/06/1995

Given that I was 8 when the code was written, I didnt understand much about S-parmeters.

As for the equations, they do follow almost directly from:
% [1] G.F. Engen, C.A. Hoer, "Thru-Reflect-Line: An Improved Technique for
% Calibrating the Dual Six-Port Automatic Network Analyser,"
% IEEE Trans. MTT, Vol. 27,No. 12, December 1979, pp. 987-998

For TRL stone, check that your line length is propper, if it is to short, you will get invalid data with no way to determine that. Please look at the issues.
